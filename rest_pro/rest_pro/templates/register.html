<!DOCTYPE html>
<html>
<head>
    <title>Register</title>
</head>
<body>

<h1>Register User</h1>

<form id="register-form">
    {% csrf_token %}
    <input name="Userid" placeholder="User ID" required>
    <input name="Username" placeholder="Username" required>
    <input name="Email" placeholder="Email" required>
    <input name="Password" placeholder="Password" type="password" required>
    <button type="submit">Register</button>
</form>

<p>Already have an account? <a href="/login/">Login Here</a></p>

<script>

/* Fast dynamic API: uses localhost for local dev, Render URL in production */
const API = (function(){
  const host = window.location.hostname;
  const isLocal = host === "127.0.0.1" || host === "localhost";

  if (isLocal) return "http://127.0.0.1:8000";
  // production backend on Render (your provided URL)
  return "https://restaurantmanagementsystem-sgt8.onrender.com";
})();



document.getElementById("register-form").addEventListener("submit", function(e) {
    e.preventDefault();

    const fd = new FormData(this);

    fetch(`${API}/add_user/`, {
        method: "POST",
        body: fd
    })
    .then(r => r.json())
    .then(data => {
        alert(data.msg || data.error || "Registered");

        if (data.msg) {
            window.location.href = "/login/";   // redirect to login page
        }
    });
});
</script>

</body>
</html>
